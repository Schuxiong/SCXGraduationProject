# UniApp 前端开发规范

## 一、项目结构
1. **基本目录结构**
    - `pages`：存放所有页面组件，每个页面一个文件夹，文件夹名称与页面路由名称保持一致，例如 `index` 页面对应的文件夹为 `pages/index`，里面包含 `index.vue` 主文件以及相关的样式文件（如 `index.scss` 或 `index.css`）、脚本文件（如 `index.js`）。
    - `components`：通用组件目录，按照组件功能分类存放，如 `button` 组件存放在 `components/button` 文件夹下，组件文件名为 `button.vue`。
    - `static`：存放静态资源，如图片、字体文件等。该目录下的文件在打包后会原封不动地复制到目标目录。
    - `utils`：工具函数目录，用于存放各种通用的工具类方法，例如网络请求封装函数、数据格式转换函数等，每个工具文件以其功能命名，如 `http.js`、`format.js`。
    - `store`：如果使用 Vuex 进行状态管理，该目录用于存放相关的 store 文件，包括 `index.js`（用于创建 Vuex 实例并导出）以及各个模块文件（如 `user.js`、`cart.js` 等，按照业务模块划分）。
2. **页面结构规范**
    - 在 `pages` 下的每个页面组件中，遵循 Vue 单文件组件规范：
        - `<template>`：模板部分，用于编写页面的 HTML 结构，应尽量保证结构清晰、层次分明，合理使用 Vue 指令进行数据绑定和事件处理。
        - `<script>`：脚本部分，用于定义页面的逻辑，包括组件的 `data`、`methods`、`computed` 等选项，以及组件的生命周期钩子函数。同时，引入所需的组件、工具函数等依赖项。
        - `<style>`：样式部分，用于设置页面的样式，优先使用 `scoped` 样式，避免样式污染全局。如果有全局样式需求，可以在 `app.vue` 的全局样式部分进行定义。

## 二、代码风格
1. **命名规范**
    - 组件名：采用大驼峰命名法（PascalCase），例如 `MyButton`、`NavBar`，且组件文件名与组件名保持一致。
    - 变量名和函数名：采用小驼峰命名法（camelCase），变量名要有意义，能够清晰表达其所代表的数据含义，如 `userList`、`getUserData`。
    - 路由名称：使用小写字母，单词之间用连字符 `-` 连接，如 `/user-info`、`/product-list`。
    - 常量：全部大写，单词之间用下划线 `_` 连接，如 `MAX_COUNT`、`API_URL`。
2. **代码缩进与格式化**
    - 使用 2 个空格进行缩进，确保代码在不同编辑器下显示一致。
    - 在保存代码时，通过编辑器的自动格式化功能（如安装 Prettier 插件）将代码按照统一格式进行整理，保持代码的整洁性。
3. **注释规范**
    - 组件注释：在每个组件文件头部，使用块注释对组件的功能、接收的属性（props）、触发的事件等进行简要说明，示例：
```javascript
/*
 * @Component: MyButton
 * @Description: 自定义按钮组件，用于常见的按钮操作场景，支持不同的按钮类型和样式
 * @Props: {
 *   type: {
 *     type: String,
 *     default: 'primary',
 *     description: '按钮类型，可选值为 primary、default、danger 等'
 *   },
 *   disabled: {
 *     type: Boolean,
 *     default: false,
 *     description: '是否禁用按钮'
 *   }
 * }
 * @Events: {
 *   click: 点击按钮时触发，返回按钮的相关信息
 * }
 */
```
    - 函数注释：在复杂函数定义上方，使用块注释说明函数的功能、参数、返回值，示例：
```javascript
/*
 * @Function: getDataFromServer
 * @Description: 从服务器获取数据并进行初步处理
 * @Params: {
 *   url: String, 数据请求的接口地址
 *   params: Object, 请求参数，默认为空对象
 * }
 * @Returns: Promise<any>, 返回一个 Promise， resolve 时包含处理后的数据， reject 时包含错误信息
 */
export function getDataFromServer(url, params = {}) {
  // 函数体
}
```
    - 代码逻辑注释：在关键代码逻辑片段附近，使用行注释对代码的作用进行解释，特别是一些复杂的条件判断、算法实现等，示例：
```javascript
if (user.isAdmin) {
  // 如果用户是管理员，展示额外的管理功能按钮
  showAdminButtons = true;
} else {
  showAdminButtons = false;
}
```

## 三、组件开发
1. **组件通信**
    - 父子组件通信：父组件通过 `props` 向子组件传递数据，子组件通过 `$emit` 触发自定义事件向父组件传递信息。在定义 `props` 时，要明确指定数据类型和默认值，避免数据类型错误引发问题。
    - 兄弟组件通信：优先考虑使用 Vuex 进行状态管理，将共享的数据放在 Vuex 的 store 中，通过 `commit` 和 `dispatch` 操作来修改和获取数据。如果数据共享范围较小且逻辑简单，也可以通过事件总线（如创建一个空的 Vue 实例作为事件中心）来实现通信，但要注意避免滥用导致代码难以维护。
2. **组件复用**
    - 提取通用组件：对于在多个页面或功能模块中重复使用的 UI 元素或功能模块，应提取为通用组件存放在 `components` 目录下。在开发组件时，要考虑组件的通用性和扩展性，尽量使其配置灵活，能够适应不同的使用场景。
    - 组件参数化：通过 `props` 让组件能够接收外部传入的参数，以定制组件的样式、行为等，避免在组件内部硬编码特定的值。

## 四、页面跳转与路由
1. **路由定义**
    - 在 `pages.json` 文件中统一配置路由信息，每个路由项包含 `path`（路由路径）、`name`（路由名称，用于编程式导航）、`component`（对应的页面组件路径）等属性。路由路径要按照模块进行合理划分，避免出现过于复杂或混乱的路由结构。
2. **页面跳转**
    - 导航方式：优先使用 UniApp 提供的 `uni.navigateTo`、`uni.redirectTo`、`uni.switchTab` 等 API 进行页面跳转，根据不同的跳转需求选择合适的方法。例如，`uni.navigateTo` 用于保留当前页面，跳转到应用内的某个页面，可以返回；`uni.redirectTo` 则是关闭当前页面，跳转到应用内的某个页面，不能返回原页面；`uni.switchTab` 用于切换底部导航栏对应的页面。
    - 传参：在页面跳转时，如果需要传递参数，通过 `query` 参数将数据传递给目标页面，目标页面在 `onLoad` 生命周期函数中通过 `options` 参数接收数据。参数传递要注意数据类型的兼容性，避免传递复杂对象时出现序列化问题。

## 五、数据请求与处理
1. **API 封装**
    - 在 `utils` 目录下创建 `http.js` 文件，对 UniApp 的网络请求 API（如 `uni.request`）进行封装，统一处理请求的 URL 前缀、请求头、错误处理等逻辑。封装后的函数应返回一个 Promise，方便在页面组件中进行异步调用。
    - 接口定义：按照业务模块将不同的 API 请求函数分别封装，函数名要清晰反映接口的功能，如 `getUserInfo`、`postProductData`。每个函数接收必要的参数，如请求参数、是否显示加载提示等。
2. **数据缓存**
    - 对于一些频繁请求且数据更新不频繁的接口，可以考虑在本地进行缓存，以提高应用的性能和响应速度。可以使用 `uni.setStorageSync` 和 `uni.getStorageSync` 等 API 实现简单的数据缓存功能，在请求数据前先从本地缓存中获取，如果缓存不存在或已过期，再发起网络请求。

## 六、样式处理
1. **样式单位**
    - 优先使用 `rpx` 作为样式单位，它是 UniApp 特有的自适应单位，能够根据屏幕宽度自动进行换算，实现页面在不同设备上的自适应显示。对于一些固定尺寸的元素，如边框宽度、图标大小等，也可以使用 `px` 单位，但要谨慎使用，避免在不同设备上出现显示异常。
2. **样式框架选择**
    - 如果项目没有特殊的样式需求，可以选择一款轻量级的 CSS 框架，如 `Tailwind CSS` 或 `Element UI` 的样式部分，来快速搭建页面样式，提高开发效率。在使用样式框架时，要遵循其文档说明进行配置和使用，避免样式冲突。

## 七、图片使用规范
1. 所有涉及图片的情况，在开发阶段先使用默认图片占位，默认图片统一存放在 `static/default_images` 目录下，图片命名要有意义，能够体现其大致用途，如 `default_product_img.png`、`default_user_avatar.jpg` 等。待整体功能开发完成且确认无误后，再手动添加真实图片。这样可以避免在开发过程中因图片加载问题或图片资源未准备好而影响开发进度，同时也方便集中管理图片资源的替换和更新。

## 八、关联新界面注意事项
1. 当项目需要关联新界面时，首先以最简单的方式实现界面的基本布局和功能跳转，确保新界面能够正常显示并与现有界面进行交互。避免一开始就在新界面中引入过多复杂的逻辑、组件或第三方库，以免影响整个项目代码的编译速度和调试效率。例如，新界面如果需要展示列表数据，先使用静态数据进行模拟展示，待核心功能稳定后，再逐步完善数据请求、动态渲染等功能。同时，在开发过程中要密切关注编译报错信息，及时解决因新界面引入而导致的依赖冲突、语法错误等问题。
